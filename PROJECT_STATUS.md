# –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ HappyRussia

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 27 –¥–µ–∫–∞–±—Ä—è 2024

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ë–µ–∫–µ–Ω–¥ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ Yandex Cloud

- **URL –±–µ–∫–µ–Ω–¥–∞:** `https://bbas207e8gbhlpbjb51u.containers.yandexcloud.net`
- **–°–µ—Ä–≤–∏—Å:** Yandex Cloud Serverless Containers
- **–ü–æ—Ä—Ç:** 8080
- **–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—Ç–∞–µ—Ç, health check –æ—Ç–≤–µ—á–∞–µ—Ç `{"status":"ok"}`

### 2. Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

- **–§–∞–π–ª:** `lib/services/api_service.dart`
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –£–∫–∞–∑–∞–Ω –ø—Ä–æ–¥–∞–∫—à–µ–Ω URL –±–µ–∫–µ–Ω–¥–∞
- **–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ —Å –±–µ–∫–µ–Ω–¥–æ–º

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –±–µ–∫–µ–Ω–¥–µ

- ‚úÖ –ü–æ—Ä—Ç –∏–∑–º–µ–Ω–µ–Ω —Å 8000 –Ω–∞ 8080 (–¥–ª—è Serverless Containers)
- ‚úÖ FastAPI: `regex` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `pattern` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)
- ‚úÖ `datetime.utcnow()` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `datetime.now(timezone.utc)`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL (`psycopg2-binary`)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è PostgreSQL

### 4. Container Registry

- **Registry ID:** `crpq885b13hnrlel0bkc`
- **–û–±—Ä–∞–∑:** `cr.yandex/crpq885b13hnrlel0bkc/happyrussia-api:latest`
- **–°—Ç–∞—Ç—É—Å:** –û–±—Ä–∞–∑ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### 5. –°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç

- **–ò–º—è:** `happyrussia-sa`
- **–†–æ–ª–∏:**
  - `container-registry.images.pusher`
  - `container-registry.images.puller`
  - `serverless.containers.editor`
  - `serverless.containers.invoker`

## ‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

### PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä

- **–°—Ç–∞—Ç—É—Å:** –°–æ–∑–¥–∞–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É)
- **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
  - –û–∫—Ä—É–∂–µ–Ω–∏–µ: `PRODUCTION`
  - –í–µ—Ä—Å–∏—è: `15`
  - –¢–∏–ø: `standard` (100% vCPU)
  - –ö–ª–∞—Å—Å: `s1.micro` (2 cores, 8 GB RAM)
  - –î–∏—Å–∫: `network-hdd` 10 GB
  - –°—Ç–æ–∏–º–æ—Å—Ç—å: ~6 302 ‚ÇΩ/–º–µ—Å
- **–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
  1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞: `happyrussia-db`
  2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∏–º—è –ë–î: `happyrussia`
  3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `happyrussia_user`
  4. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å
  5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø
  6. –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
  7. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `DATABASE_URL`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
HappyRussia/
‚îú‚îÄ‚îÄ lib/                          # Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api_service.dart      # –ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω URL
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ backend/                      # FastAPI –±–µ–∫–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py           # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SQLite –∏ PostgreSQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers/              # API endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/             # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile                # –ü–æ—Ä—Ç 8080, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt           # –í–∫–ª—é—á–∞–µ—Ç psycopg2-binary
‚îÇ   ‚îî‚îÄ‚îÄ *.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ PROJECT_STATUS.md             # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîë –í–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### Container Registry
- **ID:** `crpq885b13hnrlel0bkc`
- **URL –æ–±—Ä–∞–∑–∞:** `cr.yandex/crpq885b13hnrlel0bkc/happyrussia-api:latest`

### Serverless Container
- **URL:** `https://bbas207e8gbhlpbjb51u.containers.yandexcloud.net`
- **–ò–º—è:** `happyrussia-api`
- **–ü–æ—Ä—Ç:** 8080

### PostgreSQL (–ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è)
- **–ò–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞:** `happyrussia-db` (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **–ò–º—è –ë–î:** `happyrussia` (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** `happyrussia_user` (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **–ü–∞—Ä–æ–ª—å:** (–Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)
- **FQDN —Ö–æ—Å—Ç–∞:** (–±—É–¥–µ—Ç –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è)
- **–ü–æ—Ä—Ç:** `6432`

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä–∞:**
   - –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è
   - –î–æ–∂–¥–∞—Ç—å—Å—è —Å—Ç–∞—Ç—É—Å–∞ "Running"
   - –ü–æ–ª—É—á–∏—Ç—å FQDN —Ö–æ—Å—Ç–∞

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL:**
   - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–µ–≤–∏–∑–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL`
   - –§–æ—Ä–º–∞—Ç: `postgresql://happyrussia_user:–ü–ê–†–û–õ–¨@FQDN:6432/happyrussia`

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
   - –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–∫-–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ `backend/`:
- `SETUP_YANDEX_CLOUD.md` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex Cloud
- `SETUP_POSTGRESQL.md` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL
- `DEPLOYMENT_SUCCESS.md` - –£—Å–ø–µ—à–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- `POSTGRES_FINAL_CONFIG.md` - –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL
- –ò –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **SQLite vs PostgreSQL:**
   - –°–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
   - –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
   - SQLite –º–æ–∂–µ—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Serverless Containers

2. **–°—Ç–æ–∏–º–æ—Å—Ç—å:**
   - Serverless Container: ~–±–µ—Å–ø–ª–∞—Ç–Ω–æ (–≤ —Ä–∞–º–∫–∞—Ö free tier)
   - PostgreSQL: ~6 302 ‚ÇΩ/–º–µ—Å (—Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
   - –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –≤—ã–±—Ä–∞–≤ –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã–π –∫–ª–∞—Å—Å

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Yandex Lockbox

## üéØ –¢–µ–∫—É—â–∞—è —Ü–µ–ª—å

–ó–∞–≤–µ—Ä—à–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –µ–≥–æ –∫ –±–µ–∫–µ–Ω–¥—É.

